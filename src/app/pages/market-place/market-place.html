<div class="marketplace-container">

  <!-- Intro / Hero -->
  <section class="intro">
    <mat-card>
      <mat-card-header class="intro-title">
        <mat-card-title i18n="@@marketplaceTitle">⚓ Boat Marketplace</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p i18n="@@marketplaceDesc">
          Explore a global marketplace for buying and selling vessels of all kinds — from fishing boats to luxury
          yachts.
          Connect with trusted sellers and buyers worldwide, and make your next maritime deal with confidence.
        </p>
      </mat-card-content>
    </mat-card>
  </section>

  <!-- Marketplace Grid -->
  <section class="marketplace-grid">

    <section class="boat-filter">
      <app-boat-filter (filterChanged)="onFilterChanged($event)"></app-boat-filter>
    </section>

    <section class="boat-listings">
      <!-- Sort & Summary Bar -->
      <section class="sort-listing">
        <div class="listing-count">
          Total Listings: <strong>{{ marketplaceService.listings().length }}</strong>
        </div>

        <div class="sort-controls">
          <button matIconButton (click)="setViewMode('list')">
            <mat-icon>list_view</mat-icon>
          </button>
          <button matIconButton (click)="setViewMode('grid')">
            <mat-icon>grid_view</mat-icon>
          </button>
          <mat-form-field appearance="outline" class="sort-field" subscriptSizing="dynamic">
            <mat-label>Sort by</mat-label>
            <mat-select [(ngModel)]="sortOption" (selectionChange)="sortListings()">
              <mat-option value="Recommended">Recommended</mat-option>
              <mat-option value="newest">Listing Date: Newest First</mat-option>
              <mat-option value="oldest">Listing Date: Oldest First</mat-option>
              <mat-option value="priceHigh">Price: High to Low</mat-option>
              <mat-option value="priceLow">Price: Low to High</mat-option>
              <mat-option value="yearNew">Year: Newest</mat-option>
              <mat-option value="yearOld">Year: Oldest</mat-option>
              <mat-option value="lengthLong">Length: Longest First</mat-option>
              <mat-option value="lengthShort">Length: Shortest First</mat-option>
              <mat-option value="makeAsc">Make: A to Z</mat-option>
              <mat-option value="makeDsc">Make: Z to A</mat-option>
              <mat-option value="ditanceAsc">Distance: Nearest First</mat-option>
              <mat-option value="distanceDsc">Distance: Farthest First</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </section>


      <section class="cards-grid" [ngClass]="viewMode">
        <mat-card class="vessel-card" *ngFor="let vessel of filteredListings">
          <img mat-card-image [src]="vessel.images?.[0] || './assets/images/marine_icons/boat.png'"
            [alt]="vessel.title || 'Boat image'" />

          <div class="details-column">
            <mat-card-header>
              <mat-card-title>
                <span [routerLink]="['/marketplace/boats', vessel.id]" class="title-link">{{ vessel.title }}</span>
              </mat-card-title>
              <mat-card-subtitle class="vessel-price">{{ vessel.price | currency}} {{ vessel.currency }}</mat-card-subtitle>
              <mat-card-subtitle>{{ vessel.boatClass }} • {{ vessel.port }}</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <p>{{ vessel.description }}</p>

              <div class="owner">
                <div class="owner-details">
                  <img class="owner-avatar"
                    [src]="vessel.owner?.avatarUrl || './assets/images/marine_icons/sailor.png'">
                  <strong>@{{ vessel.owner?.username }}</strong>
                </div>
                <button matButton="">Follow</button>
              </div>
            </mat-card-content>
          </div>
        </mat-card>
      </section>

      <section class="listing-paginator">
        <mat-paginator #paginator class="demo-paginator" (page)="handlePageEvent($event)" [length]="length"
          [pageSize]="pageSize" [disabled]="disabled" [showFirstLastButtons]="showFirstLastButtons"
          [pageSizeOptions]="showPageSizeOptions ? pageSizeOptions : []" [hidePageSize]="hidePageSize"
          [pageIndex]="pageIndex" aria-label="Select page">
        </mat-paginator>
      </section>

    </section>
  </section>
</div>